#
# START DEVELOPMENT SERVERS AND PROXIES
#

#
# EDITORS
#

new_tab Editors

enabled_layouts horizontal

# Start editors

cd ~/Code/ticker
launch --title "Frontend" --copy-env

cd ~/Code/ticker-backend
launch --title "Backend" -- nix-shell /etc/nixos/shell/node12.nix

#
# SERVERS
#

new_tab Servers

enabled_layouts horizontal

# Start servers

cd ~/Code/ticker
launch --title "Frontend server" --copy-env

cd ~/Code/ticker-backend
launch --title "Backend server" -- nix-shell /etc/nixos/shell/node12.nix --command zsh

# Prefill command lines (delay for zsh launch)

launch sh -c "sleep 1 && kitty @ send-text --match title:^ticker$ 'yarn && yarn dev'"
launch sh -c "sleep 1 && kitty @ send-text --match title:^ticker-backend$ 'yarn && yarn dev'"

#
# PROXIES
#

new_tab Proxies

enabled_layouts vertical

launch --title "Proxy" /etc/nixos/secrets/convox-proxy-engine-test.sh
launch --title "Proxy" /etc/nixos/secrets/convox-proxy-engine-analytics-test.sh
launch --title "Proxy" /etc/nixos/secrets/convox-proxy-icc-test.sh
launch --title "Proxy" /etc/nixos/secrets/convox-proxy-estimates-test.sh
launch --title "Proxy" /etc/nixos/secrets/convox-proxy-chronos-test.sh

# vim:ft=kitty
